# ADR: Accept residual risk for glob/npm high-severity transitive dev dependency

Status: accepted

## Context

The CI dev dependency audit (ci/npm-audit.json) reports a high-severity advisory for `glob` and `npm` transitively required by `@semantic-release/npm`. Fixes are available upstream but require coordination and may not be immediately possible without an update to semantic-release or npm bundled tooling.

## Decision

We accept the residual risk in development dependencies for the current release while tracking the issue in a scheduled reassessment. This ADR documents the rationale and mitigations.

## Consequences and mitigations

- Owner: DevOps/Release Engineer (team)
- Reassessment: Weekly during dependency-health scheduled workflow runs
- Mitigations:
  - Do not ship production code that depends on vulnerable dev-time tooling
  - CI pipeline uses `npm ci` and runs production `npm audit` which must pass for releases
  - `ci-safety-deps.js` now produces a best-effort `dry-aged-deps`-style JSON report even when `dry-aged-deps` is unavailable, falling back to an empty `packages` list while still emitting a syntactically valid report for review
  - `ci-audit.js` runs `npm audit` in JSON mode and always writes the full result to `ci/npm-audit.json` without failing the build, ensuring advisory visibility without blocking CI
  - The JSON artifacts generated by `ci-safety-deps.js` and `ci-audit.js` (including `ci/npm-audit.json`) are ignored in `.gitignore` and are only retained as CI artifacts for security review and dependency-health analysis, not committed to the repository
  - The residual `glob`/`npm` dev dependency risks are covered by these updated CI scripts, which ensure visibility into advisories, plus strict production `npm audit` gates that must pass before a release
  - Develop a plan to upgrade `@semantic-release/npm` to a version that avoids bundling vulnerable `glob`/`npm` when safe

## References

- Vulnerability details: see ci/npm-audit.json stored in CI artifacts

Created autonomously by voder.ai
